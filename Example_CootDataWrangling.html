<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dai Shizuka" />


<title>Worked Example: Data Wrangling practice with coot chick color data</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro to R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="modules.html">Modules</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Worked Example: Data Wrangling practice
with coot chick color data</h1>
<h4 class="author">Dai Shizuka</h4>
<h4 class="date">updated 09/29/23</h4>

</div>


<p>The goal of this worked example is to demonstrate how to combine
multiple related datasets and organize data for plotting and
analysis.</p>
<p>To demonstrate how <code>dplyr</code> functions work, we will use a
dataset from a project on color variation in American coots (<em>Fulica
americana</em>). This is data comes from <a
href="https://www.pnas.org/doi/full/10.1073/pnas.1913615117">Lyon &amp;
Shizuka (2020)</a> in <em>PNAS</em>. All of the data for this paper
(much more than we will use in this exercise!) is publicly available via
Dryad <a
href="https://datadryad.org/stash/dataset/doi:10.5061%2Fdryad.ns1rn8pnv">(here)</a>.
But to simplify things, I will provide the necessary datasets below.</p>
<p>First, let’s give you a quick background on the study system:</p>
<div id="background-extreme-juvenile-ornamentation-in-american-coots"
class="section level3">
<h3>1. Background: Extreme juvenile ornamentation in American coots</h3>
<p>American coots (<em>Fulica americana</em>), a waterbird of the Rail
family. Coots lay a relatively large number of eggs (6-12 eggs) in nests
built out of old vegetation on top of water in wetlands across western
North America.</p>
<p>There are at least two very weird thing about coots: One weird thing
is that they are ‘conspecific brood parasites’–i.e., they make their own
nests, but they will also opportunistically lay eggs in their
neighboring coot nests. Our research has shown that they can, under
certain circumstances, tell which eggs and chicks in their nest are
parasitic (Lyon 2003; Shizuka &amp; Lyon 2010).</p>
<p>The other very weird thing is that they have <strong>extremely bright
ornamental juvenile traits (red beaks, red head, orange plumes around
the neck, etc.)</strong> when they hatch. They then lose these traits
over the first few weeks of life. By the time they have fledged, they
are black and gray with white beaks, and the only color they retain is a
small patch or red on their forehead. Birds commonly have bright
ornamental traits related to sexual selection, but it is relatively rare
to have such bright ornaments as babies (probably because it could make
them easy targets for predators).</p>
<div class="figure" style="text-align: center">
<img src="images/CootFeeding_lowres.jpg" alt="Figure 1: Adult coots are black and gray with a white beak. Baby coots have bright ornamentation ranging from orange to red." width="40%" />
<p class="caption">
Figure 1: Adult coots are black and gray with a white beak. Baby coots
have bright ornamentation ranging from orange to red.
</p>
</div>
<p>Past work (Lyon et al. 1994) has shown that, if you artificially
remove some of these ornaments (i.e., the orange tips of feathers around
neck), parents discriminate against these ‘dull’ chicks and
preferentially feed chicks that retain the ornaments.</p>
<p>In Lyon &amp; Shizuka (2020), we investigate the causes and
consequences of variation in color (i.e., how ‘red’ the chicks are)
within and between broods. We also link this data to patterns of
parental favoritism and survival.</p>
</div>
<div id="the-data" class="section level3">
<h3>2: The Data</h3>
<p>In this study, we monitored nests and eggs until hatching, and then
measured color of juvenile ornaments using a spectrometer (which
measures reflectance of light at different wavelengths) from ~1,500
chicks. For each chick, we got 3-5 measurements from 5 traits: pate
(bald spot on top of their head), frontal shield (fleshy part at the
base of the beak), papillae (ornamental feathers surrounding the base of
the beak), beak, and feathers surrounding the chin and neck. We have
condensed data to several key color metrics, including the ‘red chroma’
(i.e., amount of light reflected at the red wavelengths: approx
600-700nm) of the feathers around the chin. This is provided in the
“ChickColor_extracted.csv” file.</p>
<div class="figure" style="text-align: center">
<img src="images/cootchick.png" alt="Figure 2: We took color measurements for 5 different traits: pate, frontal shield, papillae, beak and chin feathers. (From Lyon &amp; Shizuka 2020)" width="50%" />
<p class="caption">
Figure 2: We took color measurements for 5 different traits: pate,
frontal shield, papillae, beak and chin feathers. (From Lyon &amp;
Shizuka 2020)
</p>
</div>
<p>We also have a separate file of relevant (non-color) data for each
chick, such “Egg ID”, which brood they were released at (the same as the
nest the egg was laid in for control treatment, but chicks were swapped
across nests in some experiments), the experimental treatment of the
brood, the nest it was laid in as an egg (Clutch), the date it was
released in the nest, the order in which they hatched in the nest/were
released at the nest, the wetland the nest is in, and whether or not the
chick is a known brood parasite.</p>
<p>Finally, we also have data for each chick as an egg, including nest,
“Egg ID”, “Chick ID”, the volume of the egg, and the laying sequence of
the egg (if known).</p>
<p>Here is the <a href="data/coot_example.zip">link to the data .zip
file</a>. Download this file and extract the contents. There should be
three .csv files. Save these files in the “data” subfolder within the
project folder you are working in.</p>
<p>Then import this data to R:</p>
<pre class="r"><code>eggs=read.csv(&quot;data/coot_example/EggMaster.csv&quot;)
head(eggs)</code></pre>
<pre><code>##   Nest Egg.Number Egg.ID Chick.ID Egg.Volume True.Lay.Seq
## 1 5001          1 5001-1   5001-1   30.88715          1.5
## 2 5001          2 5001-2   5001-2   34.48371          1.5
## 3 5001          3 5001-3   5001-3   35.03021          3.0
## 4 5001          4 5001-4   5001-4   32.17131          4.0
## 5 5001          5 5001-5   5001-5   34.42925          5.0
## 6 5001          6 5001-6   5001-6   33.62230          6.0</code></pre>
<pre class="r"><code>chicks=read.csv(&quot;data/coot_example/ChickMaster.csv&quot;)
head(chicks)</code></pre>
<pre><code>##   new.id Egg.ID Brood Brood.Treatment Clutch Release.Date Release.Order
## 1 5001-1      1  5001         Control   5001      5/31/09             1
## 2 5001-3      3  5001         Control   5001      5/31/09             1
## 3 5001-2      2  5001         Control   5001       6/1/09             2
## 4 5001-4      4  5001         Control   5001       6/1/09             2
## 5 5001-5      5  5001         Control   5001       6/1/09             2
## 6 5001-6      6  5001         Control   5001       6/1/09             2
##    Wetland Year is.parasite
## 1 Jaimeson 2005       FALSE
## 2 Jaimeson 2005       FALSE
## 3 Jaimeson 2005       FALSE
## 4 Jaimeson 2005       FALSE
## 5 Jaimeson 2005       FALSE
## 6 Jaimeson 2005       FALSE</code></pre>
<pre class="r"><code>color.dat=read.csv(&quot;data/coot_example/chickcolor_extracted.csv&quot;)
head(color.dat)</code></pre>
<pre><code>##    new.id beak_brightness beak_chroma beak_hue chin_brightness chin_chroma
## 1  5001-1       10115.318   0.8532340 582.1150       12648.380   0.6659823
## 2 5001-10       10977.933   0.7953767 594.1525        9211.256   0.7001972
## 3 5001-11       10969.117   0.8613368 588.8400       11616.203   0.7429716
## 4 5001-12        9497.939   0.7500069 592.8750       10057.130   0.6928042
## 5  5001-2        9923.183   0.8040354 593.9125        7949.278   0.6054178
## 6  5001-3       14946.204   0.7637146 578.6500        8907.490   0.6780352
##   chin_hue papillae_brightness papillae_chroma papillae_hue pate_brightness
## 1 570.3617            9325.070       0.7890137     580.3625       15474.545
## 2 573.5717           10188.617       0.7627703     576.8100        9317.368
## 3 578.9867            8165.336       0.8307054     588.9350       14178.030
## 4 564.5883            7749.599       0.8482111     583.8225        7336.676
## 5 563.4117            8355.776       0.7464439     581.0875       12269.134
## 6 568.0750           10786.379       0.7750680     580.6625       17211.539
##   pate_chroma pate_hue shield_brightness shield_chroma shield_hue
## 1   0.4914841 587.1125          8704.063     0.6595279   599.1200
## 2   0.5277203 587.5950          2850.588     0.8956101   608.4767
## 3   0.4947311 586.1775                NA            NA         NA
## 4   0.4649026 590.1575          4964.597     0.8694237   591.1200
## 5   0.4618946 588.8775          2605.885     0.9783022   605.1800
## 6   0.4502956 588.4325          7074.740     0.7431128   594.1650</code></pre>
</div>
<div id="lets-get-coding" class="section level2">
<h2>3. Let’s get coding!</h2>
<div id="load-the-packages-you-need" class="section level3">
<h3>3.1. Load the packages you need</h3>
<pre class="r"><code>library(tidyverse)</code></pre>
</div>
<div id="correlations-between-color-traits" class="section level3">
<h3>3.2. Correlations between color traits</h3>
<p>I will select just the columns of the color data that contains the
word “chroma”. Then, I will rename the variables to add a number in
front of the name. This will just help me customize the order of the
rows and columns on the matrix that I generate.</p>
<pre class="r"><code>chroma.dat=color.dat %&gt;% dplyr::select(contains(&quot;_chroma&quot;)) %&gt;% 
  rename(`5_pate`=pate_chroma, `4_shield`=shield_chroma, `3_beak`=beak_chroma, `2_papillae`=papillae_chroma, `1_chin`=chin_chroma)</code></pre>
<p>set up correlation matrix for plotting</p>
<pre class="r"><code>cor.m=cor(chroma.dat, use=&quot;complete.obs&quot;)
cor.m=cor.m[order(rownames(cor.m)),order(rownames(cor.m))] #reorder columns and rows</code></pre>
<p>Convert the data in the correlation matrix into a two-column format
that ggplot likes.</p>
<pre class="r"><code>cor.data.frame=data.frame(expand.grid(colnames(cor.m), rownames(cor.m)), value=as.vector(cor.m))</code></pre>
<p>generate correlation plots for chroma</p>
<pre class="r"><code>ggplot(cor.data.frame, aes(x=Var1, y=Var2, fill=value)) +
  geom_tile() +
  scale_fill_gradient2(limits=c(0, 1), low=&quot;white&quot;, high=&quot;red&quot;)</code></pre>
<p><img src="Example_CootDataWrangling_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="look-at-how-chick-colors-differ-between-broods"
class="section level2">
<h2>Look at how chick colors differ between broods</h2>
</div>
<div
id="make-a-global-dataset-that-contains-chick-color-chick-master-and-egg-data"
class="section level2">
<h2>make a global dataset that contains chick color, chick master, and
egg data…</h2>
<p>We are going to use a set of <code>left_join()</code> functions to
create a global dataset.</p>
<pre class="r"><code>all.dat=left_join(chicks, color.dat, by=join_by(new.id==new.id)) %&gt;%
  left_join(., eggs, by=join_by(new.id==Chick.ID)) %&gt;%
  tibble()</code></pre>
</div>
<div id="section" class="section level2">
<h2></h2>
<p>Only chick color data variables contain “_”</p>
<pre class="r"><code>pca.result=all.dat%&gt;% select(contains(&quot;_&quot;)) %&gt;% drop_na() %&gt;% prcomp(.,  scale=T)</code></pre>
<pre class="r"><code>str(pca.result)</code></pre>
<pre><code>## List of 5
##  $ sdev    : num [1:15] 1.78 1.36 1.3 1.14 1.07 ...
##  $ rotation: num [1:15, 1:15] 0.265 -0.293 -0.164 0.209 -0.419 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:15] &quot;beak_brightness&quot; &quot;beak_chroma&quot; &quot;beak_hue&quot; &quot;chin_brightness&quot; ...
##   .. ..$ : chr [1:15] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot; ...
##  $ center  : Named num [1:15] 1.13e+04 7.89e-01 5.86e+02 1.20e+04 6.96e-01 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:15] &quot;beak_brightness&quot; &quot;beak_chroma&quot; &quot;beak_hue&quot; &quot;chin_brightness&quot; ...
##  $ scale   : Named num [1:15] 2.37e+03 5.23e-02 9.80 2.53e+03 3.92e-02 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:15] &quot;beak_brightness&quot; &quot;beak_chroma&quot; &quot;beak_hue&quot; &quot;chin_brightness&quot; ...
##  $ x       : num [1:1437, 1:15] 0.2833 1.4934 0.4125 0.387 -0.0496 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:15] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;prcomp&quot;</code></pre>
<pre class="r"><code>#just look at the &quot;upper left corner&quot; of the PCA results, which is stored in the pca.result object 
pca.result$x[1:10, 1:5]</code></pre>
<pre><code>##               PC1        PC2         PC3        PC4         PC5
##  [1,]  0.28334272  1.2027289 -2.47263375 -0.8195446  0.47769007
##  [2,]  1.49341123  1.2148421 -1.29198351  1.3383028 -0.08978199
##  [3,]  0.41249201  0.1436609  2.62136790 -1.6983799 -0.26963890
##  [4,]  0.38697092  1.3665532  0.23732485 -0.9882036 -0.72247396
##  [5,] -0.04955557  1.0288544 -0.02626878  0.7272486  0.49097141
##  [6,] -1.17586007 10.8977734 -8.58085104  0.9455950  1.99997349
##  [7,] -0.30400310 -0.3557295 -1.59851521 -1.3690483  0.44316677
##  [8,] -0.68635256  0.3886334  0.78856939  1.2003471 -0.01947650
##  [9,] -0.73026492  1.1107476  2.22399541 -1.1424960 -0.81175298
## [10,] -0.98494569  1.2953843  0.44568157 -0.7403225 -2.03084378</code></pre>
<p>We can extract the first PCA axis</p>
<pre class="r"><code>head(pca.result$x[,1])</code></pre>
<pre><code>## [1]  0.28334272  1.49341123  0.41249201  0.38697092 -0.04955557 -1.17586007</code></pre>
<p>So we can add this to the global dataset:</p>
<pre class="r"><code>all.dat= all.dat %&gt;% 
  select(new.id, Clutch, contains(&quot;_&quot;)) %&gt;%
  drop_na() %&gt;%
  mutate(pc1=pca.result$x[,1]) %&gt;%
  mutate(Clutch=factor(Clutch)) %&gt;%
  data.frame()</code></pre>
<p>##Table 1</p>
<pre class="r"><code>color.columns=as.numeric(c(grep(&quot;_&quot;,colnames(all.dat)), grep(&quot;PC&quot;, colnames(all.dat))))
aov.results=list()
for (i in 1:length(color.columns)){
  aov.results[[i]]=summary(aov(all.dat[,color.columns[i]]~as.factor(all.dat$Clutch)))
}</code></pre>
<pre class="r"><code>result.dat=data.frame(trait=names(all.dat)[color.columns], Fvalue=round(sapply(1:length(color.columns), function(x) aov.results[[x]][[1]]$`F value`[1]), digits=3), Pvalue=round(sapply(1:length(color.columns), function(x) aov.results[[x]][[1]]$`Pr(&gt;F)`[1]), digits=5))
result.dat$p.adjust=p.adjust(result.dat$Pvalue, method=&quot;fdr&quot;)
result.dat #Table 1</code></pre>
<pre><code>##                  trait Fvalue  Pvalue     p.adjust
## 1      beak_brightness  2.298 0.00000 0.0000000000
## 2          beak_chroma  2.529 0.00000 0.0000000000
## 3             beak_hue  2.099 0.00000 0.0000000000
## 4      chin_brightness  2.779 0.00000 0.0000000000
## 5          chin_chroma  4.248 0.00000 0.0000000000
## 6             chin_hue  3.895 0.00000 0.0000000000
## 7  papillae_brightness  2.023 0.00000 0.0000000000
## 8      papillae_chroma  2.245 0.00000 0.0000000000
## 9         papillae_hue  2.758 0.00000 0.0000000000
## 10     pate_brightness  1.933 0.00000 0.0000000000
## 11         pate_chroma  3.186 0.00000 0.0000000000
## 12            pate_hue  0.816 0.98536 0.9853600000
## 13   shield_brightness  1.238 0.00797 0.0085392857
## 14       shield_chroma  1.556 0.00000 0.0000000000
## 15          shield_hue  1.387 0.00010 0.0001153846</code></pre>
<div
id="filter-out-parasite-chicks-and-then-calculate-mean-chick-color-for-each-brood"
class="section level3">
<h3>3.2. Filter out parasite chicks and then calculate mean chick color
for each brood</h3>
<pre class="r"><code>#dplyr way, with piping
#sum.dat=dat %&gt;% dplyr::filter(is.parasite==FALSE) %&gt;% 
  group_by(nest) %&gt;% 
  summarise(mean.col=mean(chin_chroma))
#sum.dat</code></pre>
</div>
<div
id="task-2-standardize-each-chicks-color-measure-against-average-of-its-nest."
class="section level3">
<h3>task 2: standardize each chick’s color measure against average of
its nest.</h3>
<pre class="r"><code>#with dyplr
#left_join(dat, sum.dat, by=&quot;nest&quot;) %&gt;% tibble()</code></pre>
<pre class="r"><code>#left_join(dat, sum.dat, by=&quot;nest&quot;) %&gt;%
  mutate(std.chick.col=chin_chroma-mean.col)
#head(dat)</code></pre>
<div id="section-1" class="section level5">
<h5></h5>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
