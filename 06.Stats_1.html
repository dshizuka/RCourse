<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dai Shizuka" />


<title>Module 6: Some Simple Stats</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro to R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="modules.html">Modules</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Module 6: Some Simple Stats</h1>
<h4 class="author">Dai Shizuka</h4>
<h4 class="date">updated 09/17/19</h4>

</div>


<p>I expect that many, if not all of you are here to learn how to do statistical analyses in R. However, from the beginning, I have told you that this is not a “Stats Class”, as I am not going over any principles of statistics. Nevertheless, I will go through some examples of simple statistical analyses that will get you familiar with the language and syntax of statistical functions in R.</p>
<hr />
<div id="chi-square-testing-differences-between-frequencies-across-categories" class="section level2">
<h2>1. Chi-square: Testing differences between frequencies across categories</h2>
<p>The Chi-square, or contingency table analysis, is an analysis of count data. Let’s consider this simple example:</p>
<p>Let’s say you’ve collected data on two color morphs of moths: gray and white. Your hypothesis is that dark morphs are more likely to live in dark (industrial) backgrounds. Here’s your data:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Industrial</th>
<th align="left">Rural</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Gray</td>
<td align="left">115</td>
<td align="left">30</td>
</tr>
<tr class="even">
<td align="left">White</td>
<td align="left">85</td>
<td align="left">70</td>
</tr>
</tbody>
</table>
<p>Let’s start by entering this data into R as a matrix:</p>
<pre class="r"><code>moths=matrix(c(115, 30, 85, 70), nrow=2, byrow=TRUE, dimnames=list(c(&quot;Gray&quot;, &quot;White&quot;), c(&quot;Industrial&quot;, &quot;Rural&quot;)))
moths</code></pre>
<pre><code>##       Industrial Rural
## Gray         115    30
## White         85    70</code></pre>
<p>Here’s a simple way to create a bar plot to compare frequencies across two different factors:</p>
<pre class="r"><code>barplot(moths, beside=TRUE, legend=TRUE, col=c(&quot;darkgray&quot;, &quot;white&quot;))</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>So visually, the data seems to support our hypothesis: there are relatively more black individuals in the industrial site. Now let’s test this with a Chi-square test:</p>
<pre class="r"><code>chisq.test(moths)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  moths
## X-squared = 19.103, df = 1, p-value = 1.239e-05</code></pre>
<hr />
</div>
<div id="anova-comparing-a-continuous-variable-across-groups" class="section level2">
<h2>2. ANOVA: Comparing a continuous variable across groups</h2>
<div id="a-simple-example-with-chickwts" class="section level3">
<h3>2.1 A simple example with <code>chickwts</code></h3>
<p>Analysis of Variance (ANOVA) is a way to compare whether groups (e.g., different sites, different treatments, etc.) differ in some measured continuous variable. What ANOVA does is partition variation into within-group and across-group variation. We conclude that groups are different if the variation across groups is much larger than the variation within groups.</p>
<p>Let’s first start by plotting a bar plot and standard errors of the means (SEMs) for the <code>chickwts</code> dataset, which is pre-loaded in R. This dataset comes from an experiment where newly hatched chicks were randomly allocated into 6 groups, and each group was fed with a different feed supplement. The chicks were all weighed at 6 weeks old.</p>
<p>Let’s check out the dataset first:</p>
<pre class="r"><code>?chickwts #This will give you a help file that includes information about the dataset. 
head(chickwts)</code></pre>
<pre><code>##   weight      feed
## 1    179 horsebean
## 2    160 horsebean
## 3    136 horsebean
## 4    227 horsebean
## 5    217 horsebean
## 6    168 horsebean</code></pre>
<p>Now let’s try plotting the data.</p>
<pre class="r"><code>plot(weight~feed,data=chickwts)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>We get the sense that there are some differences in chick weights based on feed supplement. Let’s test this hypothesis with ANOVA using the <code>aov()</code> function.</p>
<pre class="r"><code>aov.mod=aov(weight~feed, data=chickwts) 
summary(aov.mod)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## feed         5 231129   46226   15.37 5.94e-10 ***
## Residuals   65 195556    3009                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The output answers are major question: Yes, there is a significant difference between treatments.</p>
</div>
<div id="testing-assumptions-of-anova" class="section level3">
<h3>2.2 Testing Assumptions of ANOVA</h3>
<p>The second thing we’ll likely want to do is to test our assumptions. You can do this graphically:</p>
<pre class="r"><code>plot(aov.mod)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-8-1.png" width="384" /><img src="06.Stats_1_files/figure-html/unnamed-chunk-8-2.png" width="384" /><img src="06.Stats_1_files/figure-html/unnamed-chunk-8-3.png" width="384" /><img src="06.Stats_1_files/figure-html/unnamed-chunk-8-4.png" width="384" /></p>
<p>The first plot looks at residual vs. fitted values—if there are weird patterns here, e.g., the points “fan out” towards the right side of the plot, then you might have heteroscedasticity (variance differs across treatments with different means). The second plot looks for non- normality of errors. Ideally, you want this “qqplot” to look fairly straight. The third plot is the “standardized” (or “studentized”) residuals plotted against the fitted values—this should also look fairly flat. The fourth plot looks for patterns related to leverage, or the degree of influence a data point has on the patterns.</p>
<p>Another way to check for heteroscedasticity in the data is to use statistical tests, such as Bartlett test, Fligner-Killeen test, or Levene’s test. E.g.,</p>
<pre class="r"><code>fligner.test(weight~feed,data=chickwts)</code></pre>
<pre><code>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  weight by feed
## Fligner-Killeen:med chi-squared = 3.8109, df = 5, p-value = 0.577</code></pre>
<p>This test suggests that the groups have no significant differences in variance, so that’s good.</p>
</div>
<div id="posthoc-tests" class="section level3">
<h3>2.3 Posthoc tests</h3>
<p>The above ANOVA analysis told us that there are differences among groups. However, that is not quite that useful. What we really want to know is which groups are different from each other? To ask this question, you need to conduct pairwise comparisons. You could do a series of two-sample t-tests, but this is not so robust when you do too many comparisons at once. A standard procedure for post-hoc multiple comparisons is the Tukey’s HSD (hostly significant difference) test. You can conduct that simply in R:</p>
<pre class="r"><code>thsd=TukeyHSD(aov.mod) 
thsd</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = weight ~ feed, data = chickwts)
## 
## $feed
##                            diff         lwr       upr     p adj
## horsebean-casein    -163.383333 -232.346876 -94.41979 0.0000000
## linseed-casein      -104.833333 -170.587491 -39.07918 0.0002100
## meatmeal-casein      -46.674242 -113.906207  20.55772 0.3324584
## soybean-casein       -77.154762 -140.517054 -13.79247 0.0083653
## sunflower-casein       5.333333  -60.420825  71.08749 0.9998902
## linseed-horsebean     58.550000  -10.413543 127.51354 0.1413329
## meatmeal-horsebean   116.709091   46.335105 187.08308 0.0001062
## soybean-horsebean     86.228571   19.541684 152.91546 0.0042167
## sunflower-horsebean  168.716667   99.753124 237.68021 0.0000000
## meatmeal-linseed      58.159091   -9.072873 125.39106 0.1276965
## soybean-linseed       27.678571  -35.683721  91.04086 0.7932853
## sunflower-linseed    110.166667   44.412509 175.92082 0.0000884
## soybean-meatmeal     -30.480519  -95.375109  34.41407 0.7391356
## sunflower-meatmeal    52.007576  -15.224388 119.23954 0.2206962
## sunflower-soybean     82.488095   19.125803 145.85039 0.0038845</code></pre>
<p>This test suggests that there are significance difference between:</p>
<ul>
<li>linseed vs. casein</li>
<li>soybean vs. casein</li>
<li>meatmeal vs. horsebean</li>
<li>soybean vs. horsebean</li>
<li>sunflower vs. horsebean</li>
<li>sunflower vs. linseed</li>
<li>sunflower vs. soybean</li>
</ul>
<p>Look at the boxplot again and see if those results make sense:</p>
<pre class="r"><code>plot(weight~feed,data=chickwts)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<table style="width:75%;">
<colgroup>
<col width="22%" />
<col width="29%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th>Test</th>
<th>Description</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Two-sample T-Test</td>
<td>Parametric test of means of two groups</td>
<td><code>t.test()</code></td>
</tr>
<tr class="even">
<td>Mann-Whitney U-test</td>
<td>Non-parametric version of two-sample t</td>
<td><code>wilcox.test()</code></td>
</tr>
<tr class="odd">
<td>Kruskall-Wallis test</td>
<td>Non-parametric comparison of two or more groups</td>
<td><code>kruskal.test()</code></td>
</tr>
<tr class="even">
<td>Welch’s test</td>
<td>ANOVA with relaxed assumption about heterogeneous variances</td>
<td><code>oneway.test()</code></td>
</tr>
<tr class="odd">
<td>Paired t-test</td>
<td>Two-sample t-test for repeated measures</td>
<td><code>t.test(paired=TRUE)</code></td>
</tr>
<tr class="even">
<td>Wilcoxon signed-rank test</td>
<td>Nonparametric version of paired t</td>
<td><code>Wilcox.test(paired=TRUE)</code></td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="linear-regression" class="section level2">
<h2>3. Linear Regression</h2>
<p>Now we are going to explore the relationship of one continuous variable to another continuous variable using a linear regression.</p>
<p>Linear regression, ANOVA and other analysis (e.g., ANCOVA) are all part of a general technique referred to as General Linear Models, which allows for the analysis of continuous and categorical variables. This is different from Generalized Linear Models, which additionally allows for distributions to be other than normal. Very confusing, I know.</p>
<p>To demonstrate linear regression and its extension, the ANCOVA, we will use a dataset called <code>mtcars</code>. This is a dataset on the performance of car models from 1974 <em>Motor Trend US</em> magazine.</p>
<pre class="r"><code>?mtcars
head(mtcars)</code></pre>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>First, let’s plot something… like the relationship between the weight of the car and its fuel efficiency</p>
<pre class="r"><code>plot(mpg~wt, data=mtcars, pch=19)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>You can see there is going to be some strong relationship here. Let’s investigate this as a linear regression using the function <code>lm()</code>:</p>
<pre class="r"><code>lm.mod=lm(mpg~wt, data=mtcars)
summary(lm.mod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5432 -2.3647 -0.1252  1.4096  6.8727 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***
## wt           -5.3445     0.5591  -9.559 1.29e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.046 on 30 degrees of freedom
## Multiple R-squared:  0.7528, Adjusted R-squared:  0.7446 
## F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</code></pre>
<p>You can see this is a very strong relationship, with <span class="math inline">\(R^2 = 0.74\)</span> and very low P-value.</p>
<p>We can plot this relationship onto the scatterplot:</p>
<pre class="r"><code>plot(mpg~wt, data=mtcars, pch=19)
lm.mod=lm(mpg~wt, data=mtcars)
xv=seq(min(mtcars$wt), max(mtcars$wt), length=2)
yv=predict(lm.mod, data.frame(wt=xv))
lines(xv, yv)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="ancova-testing-the-effects-of-a-continuous-variable-a-categorical-factor" class="section level2">
<h2>4. ANCOVA: Testing the effects of a continuous variable &amp; a categorical factor</h2>
<div id="performing-an-ancova" class="section level3">
<h3>4.1 Performing an ANCOVA</h3>
<p>Continuing with the above example using <code>mtcars</code> … Let’s look a little bit closer at the data. Now we will plot the relationship between car weight and fuel efficiency, but looking at automatic vs. manual transmission cars.</p>
<pre class="r"><code>my.pal=c(&quot;tomato&quot;, &quot;slateblue&quot;)
plot(mpg~wt, data=mtcars, pch=19, col=my.pal[as.numeric(mtcars$am)+1], cex=2)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The <code>mtcars$am</code> variable is 0 = automatic and 1 = manual (see help file <code>?mtcars</code>). So the above code will put the automatic transmission in “tomato” and manual transmission in “slateblue”.</p>
<p>Overall, it seems that manual transmission is lighter, and it also tends to get better gas mileage. But is the relationship between weight and fuel efficiency different between the two transmission types? This is the question we can get at with an ANCOVA.</p>
<p>There are at least two ways to do this.</p>
<p>Option 1: Use <code>aov()</code> to fit model and see output using <code>summary()</code></p>
<pre class="r"><code>mtcars$trans.type=factor(mtcars$am)
ancova.mod1=aov(mpg~wt*trans.type, data=mtcars)
summary(ancova.mod1)</code></pre>
<pre><code>##               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## wt             1  847.7   847.7  126.25 6.92e-12 ***
## trans.type     1    0.0     0.0    0.00  0.98556    
## wt:trans.type  1   90.3    90.3   13.45  0.00102 ** 
## Residuals     28  188.0     6.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Option 1: Use <code>lm()</code> to fit model and use <code>anova()</code> to see output</p>
<pre class="r"><code>ancova.mod2=lm(mpg~wt*trans.type, data=mtcars)
anova(ancova.mod2)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: mpg
##               Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
## wt             1 847.73  847.73 126.2518 6.915e-12 ***
## trans.type     1   0.00    0.00   0.0003  0.985556    
## wt:trans.type  1  90.31   90.31  13.4502  0.001017 ** 
## Residuals     28 188.01    6.71                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>You can see that they give you identical results (with one-digit difference in rounding).</p>
</div>
<div id="plotting-the-results" class="section level3">
<h3>4.2 Plotting the results</h3>
<p>Ok, so the above results suggest that there is some <em>interaction effect</em> between weight and transmission type on fuel efficiency. Let’s visualize this by running two linear models independently on each transmission type and then drawing the model fits on top of the scatter plots.</p>
<pre class="r"><code>auto.dat=subset(mtcars, am==0)
manu.dat=subset(mtcars, am==1)
lm.auto=lm(mpg~wt, data=auto.dat)
lm.manu=lm(mpg~wt, data=manu.dat)
my.pal=c(&quot;tomato&quot;, &quot;slateblue&quot;)
plot(mpg~wt, data=mtcars, pch=19, col=my.pal[as.numeric(mtcars$am)+1], cex=2)
abline(lm.auto, col=&quot;tomato&quot;, lwd=2)
abline(lm.manu, col=&quot;slateblue&quot;, lwd=2)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>A more complicated routine, but a prettier plot:</p>
<pre class="r"><code>my.pal=c(&quot;tomato&quot;, &quot;slateblue&quot;)
plot(mpg~wt, data=mtcars, pch=19, col=my.pal[as.numeric(mtcars$am)+1], cex=2)

xv0=seq(min(auto.dat$wt), max(auto.dat$wt), length=10)
yv0=predict(lm.auto, data.frame(wt=xv0))
lines(xv0, yv0, col=&quot;tomato&quot;, lwd=2)

xv1=seq(min(manu.dat$wt), max(manu.dat$wt), length=11)
yv1=predict(lm.manu, data.frame(wt=xv1))
lines(xv1, yv1, col=&quot;slateblue&quot;, lty=2, lwd=2)</code></pre>
<p><img src="06.Stats_1_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="linear-mixed-models" class="section level2">
<h2>Linear Mixed Models</h2>
<p>Mixed effects models are often used to analyze ‘nested’ or ‘hierarchical’ data. For example, in a repeated measures design, the same measurement is taken from a subject over different times and perhaps different treatments. If your objective is to understand the overall effects of time or treatment, then you want to account for variations among individuals.</p>
<p>There are several packages for conducting mixed-effects models in R. Perhaps the most commonly used package is <code>lme4()</code>. Use the codes below to load the package, learn about one of the datasets that come with the package (called <code>sleepstudy</code>) and a simple use of the <code>lmer()</code> function to conduct a mixed model analysis.</p>
<blockquote>
<p><span style="color:purple"><strong>Downloading and installing packages</strong></span></p>
<p>To do this part, you will need to download and install a stats package that can handle linear mixed-effects models. The one we will use here is <code>lme4</code>.</p>
</blockquote>
<blockquote>
<p>You can install this package by running the command: <code>install.packages('lme4')</code> In addition, we will use the <code>lmerTest</code> package to generate a P-value from the linear mixed-effects model. To install that package, run <code>install.packages('lmerTest')</code></p>
</blockquote>
<pre class="r"><code>library(lme4) 
library(lmerTest)
?sleepstudy</code></pre>
<pre class="r"><code>mix.mod1=lmer(Reaction~Days+ (Days|Subject), data=sleepstudy) #mixed effects model of Days, with Days nested in Subject as random effect summary(mix.mod1) #summary of lmer output does not give you p-values
anova(mix.mod1)</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##      Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
## Days  30024   30024     1 16.995  45.843 3.273e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
