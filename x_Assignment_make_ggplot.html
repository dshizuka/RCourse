<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2025-09-15" />

<title>Assignment: Make this plot!</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro to R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="modules.html">Modules</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Assignment: Make this plot!</h1>
<h4 class="date">2025-09-15</h4>

</div>


<div
id="assignment-recreate-a-figure-form-a-published-paper-or-make-it-better"
class="section level2">
<h2>Assignment: Recreate a figure form a published paper (or make it
better)</h2>
<div id="intro" class="section level3">
<h3>Intro:</h3>
<p>For this assignment, I want you to do the best you can to recreate a
figure from a published paper.</p>
<p>I’ve chose a paper called <em>Temporal trends in allometry of shell
calcification in northeastern Pacific venerid bivalves: implications for
predicting responses to climate change</em> by Elizabeth Bullard and
Kaustuv Roy, published in Biology Letters in August 2025.</p>
<p><a
href="https://royalsocietypublishing.org/doi/10.1098/rsbl.2025.0181"
class="uri">https://royalsocietypublishing.org/doi/10.1098/rsbl.2025.0181</a></p>
<p>In this paper, the authors calculate allometric relationships between
size and shell thickness for 5 species of bivalves across two different
geologic time periods (Pleistocene and Holocene). They find that there
are differences in these relationships across geologic time, and that
the changes are species specific.</p>
<p>… which is interesting, but this exercise is not about the scientific
finding itself. Instead, I want you to use their data and try
reproducing their Figure 3, which looks like this:</p>
<pre class="r"><code>knitr::include_graphics(&quot;images/Bullard_Roy_figure3.png&quot;)</code></pre>
<p><img src="images/Bullard_Roy_figure3.png" width="649" /></p>
</div>
<div id="download-the-data" class="section level3">
<h3>Download the data:</h3>
<p>The raw data for this paper is available for open access through the
Dryad data repository: <a
href="https://datadryad.org/dataset/doi:10.5061/dryad.qrfj6q5st"
class="uri">https://datadryad.org/dataset/doi:10.5061/dryad.qrfj6q5st</a></p>
<p><strong>However,</strong> Figure 3 plots values that involve slightly
complicated calculations for size (log of mean-centered values within
each species/time). Since I want to focus here just on the graphics, I
have created an appended dataset, which you can download <a
href="%22data/Bullard_Roy_Data_w_log.csv%22">here</a> and then
import.</p>
<p>Or alternatively, you can just import the data via the url like
this:</p>
<pre class="r"><code>dat=read.csv(&quot;https://dshizuka.github.io/RCourse/data/Bullard_Roy_Data_w_log.csv&quot;)</code></pre>
</div>
<div id="write-a-script-that-will-reproduce-the-figure-3."
class="section level3">
<h3>Write a script that will reproduce the Figure 3.</h3>
<p><strong><em>Now, I want you to make a plot that looks as close to the
original plot as you can!</em></strong></p>
<p>You can use whatever tools you can think of at your disposal. You can
use chatGPT. You can also collaborate with a classmate–but to the extent
that you give each other hints like functions or share websites and
tutorials (i.e., I just want to avoid a situation where one person does
the whole assignment and then another person just copies it… because
then the second person has done no learning).</p>
<p><strong>But here is the catch:</strong> You HAVE TO tell me what
resources you used.</p>
<p>To reiterate: you are allowed to use AI tools. That’s fine. I just
want you to tell me exactly what you used. So if you used an AI tool,
tell me what platform you used and what prompt you gave it.</p>
</div>
<div id="here-are-a-couple-of-tries-i-did-with-this-assignment"
class="section level3">
<h3>Here are a couple of tries I did with this assignment!</h3>
<div id="my-version-1" class="section level4">
<h4>My version 1:</h4>
<p>Here was my first try. I used facet_wrap to do this. The challenging
part was to customize the order of the plots to match the publication.
To do that, I converted the “species” column into a factor and
established “levels” according to the order in which I wanted the
figures to be plotted. I created a separate “labeller” to correctly
label the species names, which I learned how to do by googling.</p>
<p>But there were things I couldn’t correctly do with this method.
First, I couldn’t put the figure legends in each panel–facet_wrap
creates one legend for all panels. I also couldn’t figure out how to
remove the boxes at the top of the panels (though I bet I could figure
that out given enough time).</p>
<pre class="r"><code>library(ggplot2)

species.names=c(&quot;C. californiensis&quot;, &quot;C. fluctifraga&quot; , &quot;C. stultorum&quot;, &quot;C. undatella&quot;, &quot;C. staminea&quot;)

names(species.names)=c(&quot;californiensis&quot;, &quot;fluctifraga&quot; , &quot;stultorum&quot;, &quot;undatella&quot;, &quot;staminea&quot;)

dat$species=factor(dat$species, levels=c(&quot;californiensis&quot;, &quot;fluctifraga&quot; , &quot;stultorum&quot;, &quot;undatella&quot;, &quot;staminea&quot;))

ggplot(dat, aes(x=size_meancentered, y=logthickness, color=Time)) +
  geom_point(pch=19, size=0.5) +
  geom_smooth(method=&quot;lm&quot;) +
  scale_color_manual(values = c(&quot;brown&quot;, &quot;darkgray&quot;))+
  scale_shape_manual(values = c(19, 17)) +
  facet_wrap(~species, nrow=3, scales=&quot;free&quot;, dir=&quot;v&quot;, labeller=labeller(species=species.names)) +
  theme_classic() +
  ylab(&quot;log thickness&quot;) +
  xlab(&quot;log size&quot;)</code></pre>
<p><img src="x_Assignment_make_ggplot_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>My version 2:</p>
<p>Here is my second try, where I make 5 different plots and then put
them together using the <code>plot_grid()</code> function from cowplot.
This makes it so that we can have the legend in each panel. This also
makes it easier to control the labels for each panel.</p>
<pre class="r"><code>library(tidyverse)
library(cowplot)


dat= dat %&gt;% mutate(species=factor(species, levels=c(&quot;californiensis&quot;, &quot;fluctifraga&quot; , &quot;stultorum&quot;, &quot;undatella&quot;, &quot;staminea&quot;)))

p1=ggplot(dat %&gt;% filter(species==&quot;californiensis&quot;), aes(x=size_meancentered, y=logthickness, color=Time)) +
  geom_point(pch=19, size=0.5) +
  geom_smooth(method=&quot;lm&quot;) +
  scale_color_manual(values = c(&quot;brown&quot;, &quot;darkgray&quot;))+
  scale_shape_manual(values = c(19, 17)) +
  theme_classic() +
  ylab(&quot;log thickness&quot;) +
  xlab(&quot;log size&quot;) +
  ggtitle(&quot;C. californiensis&quot;) +
  guides(color=guide_legend(position=&quot;inside&quot;, title=&quot;&quot;)) +
  theme(legend.justification.inside=c(1,0))

p2=ggplot(dat %&gt;% filter(species==&quot;fluctifraga&quot;), aes(x=size_meancentered, y=logthickness, color=Time)) +
  geom_point(pch=19, size=0.5) +
  geom_smooth(method=&quot;lm&quot;) +
  scale_color_manual(values = c(&quot;brown&quot;, &quot;darkgray&quot;))+
  scale_shape_manual(values = c(19, 17)) +
  theme_classic() +
  ylab(&quot;log thickness&quot;) +
  xlab(&quot;log size&quot;) +
  ggtitle(&quot;C. fluctifraga&quot;) +
  guides(color=guide_legend(position=&quot;inside&quot;, title=&quot;&quot;)) +
  theme(legend.justification.inside=c(1,0))

p3=ggplot(dat %&gt;% filter(species==&quot;stultorum&quot;), aes(x=size_meancentered, y=logthickness, color=Time)) +
  geom_point(pch=19, size=0.5) +
  geom_smooth(method=&quot;lm&quot;) +
  scale_color_manual(values = c(&quot;brown&quot;, &quot;darkgray&quot;))+
  scale_shape_manual(values = c(19, 17)) +
  theme_classic() +
  ylab(&quot;log thickness&quot;) +
  xlab(&quot;log size&quot;) +
  ggtitle(&quot;C. stultorum&quot;) +
  guides(color=guide_legend(position=&quot;inside&quot;, title=&quot;&quot;)) +
  theme(legend.justification.inside=c(1,0))

p4=ggplot(dat %&gt;% filter(species==&quot;undatella&quot;), aes(x=size_meancentered, y=logthickness, color=Time)) +
  geom_point(pch=19, size=0.5) +
  geom_smooth(method=&quot;lm&quot;) +
  scale_color_manual(values = c(&quot;brown&quot;, &quot;darkgray&quot;))+
  scale_shape_manual(values = c(19, 17)) +
  theme_classic() +
  ylab(&quot;log thickness&quot;) +
  xlab(&quot;log size&quot;) +
  ggtitle(&quot;C. undatella&quot;) +
  guides(color=guide_legend(position=&quot;inside&quot;, title=&quot;&quot;)) +
  theme(legend.justification.inside=c(1,0))

p5=ggplot(dat %&gt;% filter(species==&quot;staminea&quot;), aes(x=size_meancentered, y=logthickness, color=Time)) +
  geom_point(pch=19, size=0.5) +
  geom_smooth(method=&quot;lm&quot;) +
  scale_color_manual(values = c(&quot;brown&quot;, &quot;darkgray&quot;))+
  scale_shape_manual(values = c(19, 17)) +
  theme_classic() +
  ylab(&quot;log thickness&quot;) +
  xlab(&quot;log size&quot;) +
  ggtitle(&quot;C. staminea&quot;) +
  guides(color=guide_legend(position=&quot;inside&quot;, title=&quot;&quot;)) +
  theme(legend.justification.inside=c(1,0))

plot_grid(p1, p2, p3, p4, p5, byrow=F, ncol=2)</code></pre>
<p><img src="x_Assignment_make_ggplot_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
